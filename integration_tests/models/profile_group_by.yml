version: 2

models:
  - name: profile_group_by

    columns:
      - name: group_by
        tests:
          - dbt_expectations.expect_column_to_exist:
              config:
                enabled: "{{ target.type != 'sqlserver' }}"

    tests:
      - dbt_expectations.expect_multicolumn_sum_to_equal:
          config:
            enabled: "{{ target.type != 'sqlserver' }}"
          arguments:
            column_list: ["row_count"]
            sum_total: 2
            row_condition: "group_by = 'A' and column_name = 'id'"